class EventSystem{constructor(){return this.events={},this}getHandlersCount(e){let t=this.events[e];if(!t)return 0;let l=0,n=[];for(n.push(t);n.length>0;){let e=n.pop();for(let t in e)"_handlers"===t?l+=e[t].length:"object"==typeof e[t]&&n.push(e[t])}return l}on(e,t){let l=e.split("."),n=this.events;for(let e=0;e<l.length;e++){let s=l[e];n[s]||(n[s]={}),e===l.length-1?(Array.isArray(n[s]._handlers)||(n[s]._handlers=[]),n[s]._handlers.push(t)):n=n[s]}return this}one(e,t){let l=this,n=e+"."+String.random(8);return this.on(n,function(e){t(e),l.off(n)}),this}off(e,t=!0){let l=e.split("."),n=this.events;for(let e=0;e<l.length;e++){let s=l[e];e===l.length-1?t?delete n[s]:(delete n[s]._handlers,0===Object.keys(n[s]).length&&delete n[s]):n=n[s]}return this}emit(e,t){let l=e.split("."),n=this.events;for(let e=0;e<l.length;e++){if(!(n=n[l[e]]))return this;if(e===l.length-1){let e=[];for(e.push(n);e.length;){let l=e.pop();for(let n in l)if("_handlers"===n)for(let e=0;e<l[n].length;e++)l[n][e](t);else e.push(l[n])}}}return this}}