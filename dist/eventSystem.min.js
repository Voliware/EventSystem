class EventSystem{constructor(){this.events={}}generateRandomString(e){let t="";const n=()=>{const e=Math.floor(62*Math.random());return e<10?e:e<36?String.fromCharCode(e+55):String.fromCharCode(e+61)};for(;t.length<e;)t+=n();return t}getHandlersCount(e){const t=this.events[e];if(!t)return 0;let n=0,s=[];for(s.push(t);s.length>0;){let e=s.pop();for(let t in e)"handlers"===t?n+=e[t].length:"object"==typeof e[t]&&s.push(e[t])}return n}on(e,t){"string"!=typeof e&&(e+="");const n=e.split(".");let s=this.events;for(let e=0;e<n.length;e++){let o=n[e];s[o]||(s[o]={}),e===n.length-1?(Array.isArray(s[o].handlers)||(s[o].handlers=[]),s[o].handlers.push(t)):s=s[o]}}one(e,t){const n=e+"."+this.generateRandomString(16);this.on(n,e=>{t(e),this.off(n)})}off(e,t=null,n=!0){"string"!=typeof e&&(e+="");const s=e.split(".");let o=this.events;for(let e=0;e<s.length;e++){const l=s[e];if(e===s.length-1)if(t){const e=o[l].handlers;for(let n=0;n<e.length;n++)e[n]===t&&e.splice(n,1)}else n?delete o[l]:(delete o[l].handlers,0===Object.keys(o[l]).length&&delete o[l]);else o=o[l]}}emit(e,t){"string"!=typeof e&&(e+="");const n=e.split(".");let s=this.events;for(let e=0;e<n.length;e++){if(!(s=s[n[e]]))return;if(e===n.length-1){let e=[];for(e.push(s);e.length;){let n=e.pop();for(let s in n)if("handlers"===s)for(let e=0;e<n[s].length;e++)n[s][e](t);else e.push(n[s])}}}}static extend(e){const t=new EventSystem;e.on=t.on.bind(t),e.one=t.one.bind(t),e.off=t.off.bind(t),e.emit=t.emit.bind(t)}}"undefined"!=typeof module&&(module.exports=EventSystem);